process {
    withName: 'STAR_FOR_STARFUSION' {
        ext.args = '--twopassMode Basic \
        --outReadsUnmapped None \
        --readFilesCommand zcat \
        --outSAMtype BAM SortedByCoordinate \
        --outSAMstrandField intronMotif \
        --outSAMunmapped Within \
        --chimSegmentMin 12 \
        --chimJunctionOverhangMin 8 \
        --chimOutJunctionFormat 1 \
        --alignSJDBoverhangMin 10 \
        --alignMatesGapMax 100000 \
        --alignIntronMax 100000 \
        --alignSJstitchMismatchNmax 5 -1 5 5 \
        --chimMultimapScoreRange 3 \
        --chimScoreJunctionNonGTAG -4 \
        --chimMultimapNmax 20 \
        --chimNonchimScoreDropMin 10 \
        --peOverlapNbasesMin 12 \
        --peOverlapMMp 0.1 \
        --alignInsertionFlush Right \
        --alignSplicedMateMapLminOverLmate 0 \
        --alignSplicedMateMapLmin 30 \
        --chimOutType Junctions \
        --quantMode GeneCounts'
    }

        withName: 'SAMTOOLS_INDEX_FOR_STARFUSION_CRAM' {
        ext.prefix = { "${meta.id}.star_for_starfusion.Aligned.sortedByCoord.out" }
    }

    withName: 'SAMTOOLS_VIEW_FOR_STARFUSION' {
        ext.args = { "--output-fmt cram" }
        ext.prefix = { "${meta.id}.star_for_starfusion.Aligned.sortedByCoord.out" }
    }
}
