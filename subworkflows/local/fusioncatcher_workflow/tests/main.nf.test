nextflow_workflow {

    name "Test Subworkflow FUSIONCATCHER_WORKFLOW"
    script "../main.nf"
    workflow "FUSIONCATCHER_WORKFLOW"

    tag "subworkflow"
    tag "fusioncatcher_workflow"
    tag "fusioncatcher"

    test("FUSIONCATCHER_WORKFLOW - Stub") {
        options "-stub"

        when {
            workflow {
                """
                // Input channels
                input[0] = Channel.of(
                    [ [ id:'test_sample' ],
                    file("https://github.com/nf-core/test-datasets/raw/rnafusion/testdata/human/reads_1.fq.gz"),
                    file("https://github.com/nf-core/test-datasets/raw/rnafusion/testdata/human/reads_2.fq.gz") ]
                )

                input[1] = true

                input[2] = []

                input[3] = [
                    [ id:'fusioncatcher_ref' ],
                    []
                ]

                input[4] = []

                """
            }
            params {
                tools                   = 'fusioncatcher'
                trim_tail_fusioncatcher = 50
                outdir                  = "$outputDir"
            }
        }

        then {
            assertAll(
                { assert workflow.success },
                { assert snapshot(
                    workflow.out.versions
                ).match() }
            )
        }
    }
}
